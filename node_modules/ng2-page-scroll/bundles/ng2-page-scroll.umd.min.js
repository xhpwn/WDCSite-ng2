!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/router"),require("@angular/platform-browser"),require("@angular/common")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/router","@angular/platform-browser","@angular/common"],t):t((e.ng2=e.ng2||{},e.ng2.page=e.ng2.page||{},e.ng2.page.scroll=e.ng2.page.scroll||{}),e.ng.core,e.ng.router,e.ng["platform-browser"],e.ng.common)}(this,function(e,t,n,r,i){"use strict";var o=function(){function e(){}return e}(),l=function(){function e(){}return Object.defineProperty(e,"defaultEasingLogic",{get:function(){return e._easingLogic},set:function(t){e._easingLogic=t},enumerable:!0,configurable:!0}),e}();l._interval=10,l._minScrollDistance=2,l._defaultNamespace="default",l.defaultIsVerticalScrolling=!0,l.defaultDuration=1250,l.defaultScrollOffset=0,l._interruptEvents=["mousedown","wheel","DOMMouseScroll","mousewheel","keyup","touchmove"],l._interruptKeys=[33,34,35,36,38,40],l.defaultInterruptible=!0,l._easingLogic={ease:function(e,t,n,r){return n*e/r+t}};var c=function(){function e(){}return e.isUndefinedOrNull=function(e){return"undefined"==typeof e||void 0===e||null===e},e.extractElementPosition=function(t,n){var r=t.body,i=t.documentElement,o=t.defaultView&&t.defaultView.pageYOffset||void 0,l=t.defaultView&&t.defaultView.pageXOffset||void 0,c=o||i.scrollTop||r.scrollTop,s=l||i.scrollLeft||r.scrollLeft,a=i.clientTop||r.clientTop||0,u=i.clientLeft||r.clientLeft||0;if(e.isUndefinedOrNull(n))return{top:c,left:s};var p=n.getBoundingClientRect(),f=p.top+c-a,g=p.left+s-u;return{top:Math.round(f),left:Math.round(g)}},e}(),s=function(e,t,n,r){var i,o=arguments.length,l=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(l=(o<3?i(l):o>3?i(t,n,l):i(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l},a=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};e.PageScrollService=u=function(){function e(){var e=this;this.runningInstances=[],this.onInterrupted={report:function(t,n){n.interruptible&&("keyup"!==t.type||l._interruptKeys.indexOf(t.keyCode)>=0)&&e.stopAll(n.namespace)}},u.instanceCounter>0&&t.isDevMode()&&console.warn("An instance of PageScrollService already exists, usually including one provider should be enough, so double check."),u.instanceCounter++}return e.prototype.stopInternal=function(e,t){var n=this.runningInstances.indexOf(t);return n>=0&&this.runningInstances.splice(n,1),t.interruptListenersAttached&&t.detachInterruptListeners(),!!t.timer&&(clearInterval(t.timer),t.timer=void 0,t.fireEvent(!e),!0)},e.prototype.start=function(e){var n=this;if(this.stopAll(e.namespace),null===e.scrollingViews||0===e.scrollingViews.length)return void(t.isDevMode()&&console.warn("No scrollingViews specified, this ng2-page-scroll does not know which DOM elements to scroll"));var r=!1;e.scrollingViews.forEach(function(t){if(!c.isUndefinedOrNull(t)){var n=e.getScrollPropertyValue(t);!r&&n&&(e.startScrollPosition=n,r=!0)}});var i=e.getCurrentOffset(),o=e.extractScrollTargetPosition();if(e.targetScrollPosition=Math.round((e.verticalScrolling?o.top:o.left)-i),e.distanceToScroll=e.targetScrollPosition-e.startScrollPosition,isNaN(e.distanceToScroll))return t.isDevMode()&&console.log("Scrolling not possible, as we can't find the specified target"),void e.fireEvent(!1);var s=Math.abs(e.distanceToScroll)<l._minScrollDistance,a=e.duration<=l._interval;return s||a?(t.isDevMode()&&(s?console.log("Scrolling not possible, as we can't get any closer to the destination"):console.log("Scroll duration shorter that interval length, jumping to target")),e.setScrollPosition(e.targetScrollPosition),void e.fireEvent(!0)):((e.interruptible||c.isUndefinedOrNull(e.interruptible)&&l.defaultInterruptible)&&e.attachInterruptListeners(this.onInterrupted),e.startTime=(new Date).getTime(),e.endTime=e.startTime+e.duration,e.timer=setInterval(function(e){var t,r=(new Date).getTime(),i=!1;e.endTime<=r?(t=e.targetScrollPosition,i=!0):t=Math.round(e.easingLogic.ease(r-e.startTime,e.startScrollPosition,e.distanceToScroll,e.duration)),e.setScrollPosition(t)||(i=!0),i&&n.stopInternal(!1,e)},l._interval,e),void this.runningInstances.push(e))},e.prototype.stopAll=function(e){var t=this;if(this.runningInstances.length>0){var n=!1;return this.runningInstances.forEach(function(r){(c.isUndefinedOrNull(e)||0===e.length||r.namespace===e)&&(n=!0,t.stopInternal(!0,r))}),n}return!1},e.prototype.stop=function(e){return this.stopInternal(!0,e)},e}(),e.PageScrollService.instanceCounter=0,e.PageScrollService=u=s([t.Injectable(),a("design:paramtypes",[])],e.PageScrollService);var u,p=function(){function e(e,n){this._namespace=l._defaultNamespace,this._verticalScrolling=l.defaultIsVerticalScrolling,this._offset=l.defaultScrollOffset,this._duration=l.defaultDuration,this._easingLogic=l.defaultEasingLogic,this._interruptible=l.defaultInterruptible,this._pageScrollFinish=new t.EventEmitter,this._startScrollPosition=0,this._interruptListenersAttached=!1,this._timer=null,this._namespace=e,this.document=n}return e.simpleInstance=function(t,n,r){return e.simpleDirectionInstance(t,n,!0,r)},e.simpleDirectionInstance=function(t,n,r,i){return e.advancedInstance(t,n,null,i,r,null,null,null,null,null)},e.simpleInlineInstance=function(t,n,r,i){return e.simpleInlineDirectionInstance(t,n,r,!0,i)},e.simpleInlineDirectionInstance=function(t,n,r,i,o){return e.advancedInstance(t,n,[r],o,i,null,null,null,null,null)},e.advancedInstance=function(t,n,r,i,o,s,a,u,p,f){void 0===r&&(r=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===u&&(u=null),void 0===p&&(p=null),void 0===f&&(f=null),(c.isUndefinedOrNull(i)||i.length<=0)&&(i=l._defaultNamespace);var g=new e(i,t);return c.isUndefinedOrNull(r)||0===r.length?(g._isInlineScrolling=!1,g._scrollingViews=[t.documentElement,t.body,t.body.parentNode]):(g._isInlineScrolling=!0,g._scrollingViews=r),g._scrollTarget=n,c.isUndefinedOrNull(o)||(g._verticalScrolling=o),c.isUndefinedOrNull(s)||(g._offset=s),c.isUndefinedOrNull(u)||(g._easingLogic=u),c.isUndefinedOrNull(p)||(g._duration=p),c.isUndefinedOrNull(f)||(g._pageScrollFinish=f),g._interruptible=a||c.isUndefinedOrNull(a)&&l.defaultInterruptible,g},e.prototype.getScrollPropertyValue=function(e){return this.verticalScrolling?e.scrollTop:e.scrollLeft},e.prototype.extractScrollTargetPosition=function(){var e;return e="string"==typeof this._scrollTarget?this.document.getElementById(this._scrollTarget.substr(1)):this._scrollTarget,null===e||void 0===e?{top:NaN,left:NaN}:this._isInlineScrolling?{top:e.offsetTop,left:e.offsetLeft}:c.extractElementPosition(this.document,e)},e.prototype.getCurrentOffset=function(){return this._offset},e.prototype.setScrollPosition=function(e){var t=this;return this.scrollingViews.reduce(function(n,r){var i=t.getScrollPropertyValue(r);if(r&&!c.isUndefinedOrNull(i)){var o=Math.abs(i-e),s=o<l._minScrollDistance;if(t.verticalScrolling?r.scrollTop=e:r.scrollLeft=e,s||o>Math.abs(t.getScrollPropertyValue(r)-e))return!0}return n},!1)},e.prototype.fireEvent=function(e){this._pageScrollFinish&&this._pageScrollFinish.emit(e)},e.prototype.attachInterruptListeners=function(e){var t=this;this._interruptListenersAttached&&this.detachInterruptListeners(),this._interruptListener=function(n){e.report(n,t)},l._interruptEvents.forEach(function(e){return t.document.body.addEventListener(e,t._interruptListener)}),this._interruptListenersAttached=!0},e.prototype.detachInterruptListeners=function(){var e=this;l._interruptEvents.forEach(function(t){return e.document.body.removeEventListener(t,e._interruptListener)}),this._interruptListenersAttached=!1},Object.defineProperty(e.prototype,"namespace",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalScrolling",{get:function(){return this._verticalScrolling},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollingViews",{get:function(){return this._scrollingViews},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startScrollPosition",{get:function(){return this._startScrollPosition},set:function(e){this._startScrollPosition=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"targetScrollPosition",{get:function(){return this._targetScrollPosition},set:function(e){this._targetScrollPosition=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceToScroll",{get:function(){return this._distanceToScroll},set:function(e){this._distanceToScroll=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"easingLogic",{get:function(){return this._easingLogic},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interruptible",{get:function(){return this._interruptible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){return this._startTime},set:function(e){this._startTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endTime",{get:function(){return this._endTime},set:function(e){this._endTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timer",{get:function(){return this._timer},set:function(e){this._timer=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interruptListenersAttached",{get:function(){return this._interruptListenersAttached},enumerable:!0,configurable:!0}),e}(),f=function(e,t,n,r){var i,o=arguments.length,l=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(l=(o<3?i(l):o>3?i(t,n,l):i(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l},g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(e,t){return function(n,r){t(n,r,e)}};e.PageScroll=function(){function e(e,n,r){this.pageScrollService=e,this.router=n,this.pageScrollHorizontal=null,this.pageScrollOffset=null,this.pageScrollDuration=null,this.pageScrollEasing=null,this.pageScroll=null,this.pageScrollFinish=new t.EventEmitter,this.document=r}return e.prototype.ngOnDestroy=function(){this.pageScrollInstance&&this.pageScrollService.stop(this.pageScrollInstance)},e.prototype.generatePageScrollInstance=function(){return c.isUndefinedOrNull(this.pageScrollInstance)&&(this.pageScrollInstance=p.advancedInstance(this.document,this.href,null,this.pageScroll,!this.pageScrollHorizontal,this.pageScrollOffset,this.pageScrollInterruptible,this.pageScrollEasing,this.pageScrollDuration,this.pageScrollFinish)),this.pageScrollInstance},e.prototype.handleClick=function(e){var t=this;if(this.routerLink&&null!==this.router&&void 0!==this.router){var r=void 0;if(r="string"==typeof this.routerLink?this.router.parseUrl(this.routerLink):this.router.createUrlTree(this.routerLink),!this.router.isActive(r,!0)){var i=this.router.events.subscribe(function(e){e instanceof n.NavigationEnd?(i.unsubscribe(),t.pageScrollService.start(t.generatePageScrollInstance())):(e instanceof n.NavigationError||e instanceof n.NavigationCancel)&&i.unsubscribe()});return!1}}return this.pageScrollService.start(this.generatePageScrollInstance()),!1},e}(),f([t.Input(),g("design:type",Object)],e.PageScroll.prototype,"routerLink",void 0),f([t.Input(),g("design:type",String)],e.PageScroll.prototype,"href",void 0),f([t.Input(),g("design:type",Boolean)],e.PageScroll.prototype,"pageScrollHorizontal",void 0),f([t.Input(),g("design:type",Number)],e.PageScroll.prototype,"pageScrollOffset",void 0),f([t.Input(),g("design:type",Number)],e.PageScroll.prototype,"pageScrollDuration",void 0),f([t.Input(),g("design:type",o)],e.PageScroll.prototype,"pageScrollEasing",void 0),f([t.Input(),g("design:type",Boolean)],e.PageScroll.prototype,"pageScrollInterruptible",void 0),f([t.Input(),g("design:type",String)],e.PageScroll.prototype,"pageScroll",void 0),f([t.Output(),g("design:type",t.EventEmitter)],e.PageScroll.prototype,"pageScrollFinish",void 0),e.PageScroll=f([t.Directive({selector:"[pageScroll]",host:{"(click)":"handleClick($event)"}}),d(1,t.Optional()),d(2,t.Inject(r.DOCUMENT)),g("design:paramtypes",[e.PageScrollService,n.Router,Object])],e.PageScroll);var h=function(e,t,n,r){var i,o=arguments.length,l=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(l=(o<3?i(l):o>3?i(t,n,l):i(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};e.Ng2PageScrollModule=S=function(){function t(){}return t.forRoot=function(){return{ngModule:S,providers:[{provide:e.PageScrollService,useClass:e.PageScrollService}]}},t}(),e.Ng2PageScrollModule=S=h([t.NgModule({imports:[i.CommonModule],declarations:[e.PageScroll],exports:[e.PageScroll]})],e.Ng2PageScrollModule);var S;e.EasingLogic=o,e.PageScrollConfig=l,e.PageScrollInstance=p,e.PageScrollUtilService=c,Object.defineProperty(e,"__esModule",{value:!0})});
